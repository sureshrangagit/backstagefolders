{"version":3,"file":"OwnershipCard.esm.js","sources":["../../../../src/components/Cards/OwnershipCard/OwnershipCard.tsx"],"sourcesContent":["/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { InfoCard, InfoCardVariants } from '@backstage/core-components';\nimport { useEntity } from '@backstage/plugin-catalog-react';\nimport List from '@material-ui/core/List';\nimport ListItem from '@material-ui/core/ListItem';\nimport ListItemSecondaryAction from '@material-ui/core/ListItemSecondaryAction';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport Switch from '@material-ui/core/Switch';\nimport Tooltip from '@material-ui/core/Tooltip';\nimport { makeStyles } from '@material-ui/core/styles';\nimport { useEffect, useState } from 'react';\nimport { ComponentsGrid } from './ComponentsGrid';\nimport { EntityRelationAggregation } from '../types';\nimport { useTranslationRef } from '@backstage/frontend-plugin-api';\nimport { orgTranslationRef } from '../../../translation';\n\nconst useStyles = makeStyles(theme => ({\n  card: {\n    maxHeight: '100%',\n  },\n  cardContent: {\n    display: 'flex',\n    flexDirection: 'column',\n    overflow: 'hidden',\n  },\n  list: {\n    [theme.breakpoints.down('xs')]: {\n      padding: `0 0 12px`,\n    },\n  },\n  listItemText: {\n    [theme.breakpoints.down('xs')]: {\n      paddingRight: 0,\n      paddingLeft: 0,\n    },\n  },\n  listItemSecondaryAction: {\n    [theme.breakpoints.down('xs')]: {\n      width: '100%',\n      top: 'auto',\n      right: 'auto',\n      position: 'relative',\n      transform: 'unset',\n    },\n  },\n  grid: {\n    overflowY: 'auto',\n    marginTop: 0,\n  },\n}));\n\n/** @public */\nexport const OwnershipCard = (props: {\n  variant?: InfoCardVariants;\n  entityFilterKind?: string[];\n  hideRelationsToggle?: boolean;\n  /** @deprecated Please use relationAggregation instead */\n  relationsType?: EntityRelationAggregation;\n  relationAggregation?: EntityRelationAggregation;\n  entityLimit?: number;\n}) => {\n  const {\n    variant,\n    entityFilterKind,\n    hideRelationsToggle,\n    entityLimit = 6,\n  } = props;\n  const relationAggregation = props.relationAggregation ?? props.relationsType;\n  const relationsToggle =\n    hideRelationsToggle === undefined ? false : hideRelationsToggle;\n  const classes = useStyles();\n  const { entity } = useEntity();\n  const { t } = useTranslationRef(orgTranslationRef);\n\n  const defaultRelationAggregation =\n    entity.kind === 'User' ? 'aggregated' : 'direct';\n  const [getRelationAggregation, setRelationAggregation] = useState(\n    relationAggregation ?? defaultRelationAggregation,\n  );\n\n  useEffect(() => {\n    if (!relationAggregation) {\n      setRelationAggregation(defaultRelationAggregation);\n    }\n  }, [setRelationAggregation, defaultRelationAggregation, relationAggregation]);\n\n  return (\n    <InfoCard\n      title={t('ownershipCard.title')}\n      variant={variant}\n      className={classes.card}\n      cardClassName={classes.cardContent}\n    >\n      {!relationsToggle && (\n        <List dense>\n          <ListItem className={classes.list}>\n            <ListItemText className={classes.listItemText} />\n            <ListItemSecondaryAction\n              className={classes.listItemSecondaryAction}\n            >\n              {t('ownershipCard.aggregateRelationsToggle.directRelations')}\n              <Tooltip\n                placement=\"top\"\n                arrow\n                title={\n                  getRelationAggregation === 'direct'\n                    ? t(\n                        'ownershipCard.aggregateRelationsToggle.directRelations',\n                      )\n                    : t(\n                        'ownershipCard.aggregateRelationsToggle.aggregatedRelations',\n                      )\n                }\n              >\n                <Switch\n                  color=\"primary\"\n                  checked={getRelationAggregation !== 'direct'}\n                  onChange={() => {\n                    const updatedRelationAggregation =\n                      getRelationAggregation === 'direct'\n                        ? 'aggregated'\n                        : 'direct';\n                    setRelationAggregation(updatedRelationAggregation);\n                  }}\n                  name=\"pin\"\n                  inputProps={{\n                    'aria-label': t(\n                      'ownershipCard.aggregateRelationsToggle.ariaLabel',\n                    ),\n                  }}\n                />\n              </Tooltip>\n              {t('ownershipCard.aggregateRelationsToggle.aggregatedRelations')}\n            </ListItemSecondaryAction>\n          </ListItem>\n        </List>\n      )}\n      <ComponentsGrid\n        className={classes.grid}\n        entity={entity}\n        entityLimit={entityLimit}\n        relationAggregation={getRelationAggregation}\n        entityFilterKind={entityFilterKind}\n      />\n    </InfoCard>\n  );\n};\n"],"names":[],"mappings":"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"}