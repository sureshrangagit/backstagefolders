{"version":3,"file":"Events.esm.js","sources":["../../../../src/components/Pods/Events/Events.tsx"],"sourcesContent":["/*\n * Copyright 2023 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport Avatar from '@material-ui/core/Avatar';\nimport Container from '@material-ui/core/Container';\nimport Grid from '@material-ui/core/Grid';\nimport List from '@material-ui/core/List';\nimport ListItem from '@material-ui/core/ListItem';\nimport ListItemAvatar from '@material-ui/core/ListItemAvatar';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport Tooltip from '@material-ui/core/Tooltip';\nimport Typography from '@material-ui/core/Typography';\n\nimport InfoIcon from '@material-ui/icons/Info';\nimport WarningIcon from '@material-ui/icons/Warning';\nimport { DateTime } from 'luxon';\n\nimport { useEvents } from './useEvents';\nimport Skeleton from '@material-ui/lab/Skeleton';\nimport { DismissableBanner } from '@backstage/core-components';\nimport { Event } from 'kubernetes-models/v1';\n\n/**\n * Props for Events\n *\n * @public\n */\nexport interface EventsContentProps {\n  warningEventsOnly?: boolean;\n  events: Event[];\n}\n\nconst getAvatarByType = (type?: string) => {\n  return (\n    <ListItemAvatar>\n      <Avatar>{type === 'Warning' ? <WarningIcon /> : <InfoIcon />}</Avatar>\n    </ListItemAvatar>\n  );\n};\n\n/**\n * Shows given Kubernetes events\n *\n * @public\n */\nexport const EventsContent = ({\n  events,\n  warningEventsOnly,\n}: EventsContentProps) => {\n  if (events.length === 0) {\n    return <Typography>No events found</Typography>;\n  }\n\n  return (\n    <Container>\n      <Grid>\n        <List>\n          {events\n            .filter(event => {\n              if (warningEventsOnly) {\n                return event.type === 'Warning';\n              }\n              return true;\n            })\n            .map((event, index) => {\n              const timeAgo = event.metadata.creationTimestamp\n                ? DateTime.fromISO(event.metadata.creationTimestamp).toRelative(\n                    {\n                      locale: 'en',\n                    },\n                  )\n                : 'unknown';\n              return (\n                <ListItem key={`${event.metadata.name}-${index}`}>\n                  <Tooltip title={`${event.type ?? ''} event`}>\n                    {getAvatarByType(event.type)}\n                  </Tooltip>\n                  <ListItemText\n                    primary={`First event ${timeAgo} (count: ${event.count})`}\n                    secondary={`${event.reason}: ${event.message}`}\n                  />\n                </ListItem>\n              );\n            })}\n        </List>\n      </Grid>\n    </Container>\n  );\n};\n\n/**\n * Props for Events\n *\n * @public\n */\nexport interface EventsProps {\n  involvedObjectName: string;\n  namespace: string;\n  clusterName: string;\n  warningEventsOnly?: boolean;\n}\n\n/**\n * Retrieves and shows Kubernetes events for the given object\n *\n * @public\n */\nexport const Events = ({\n  involvedObjectName,\n  namespace,\n  clusterName,\n  warningEventsOnly,\n}: EventsProps) => {\n  const { value, error, loading } = useEvents({\n    involvedObjectName,\n    namespace,\n    clusterName,\n  });\n\n  return (\n    <>\n      {error && (\n        <DismissableBanner\n          {...{\n            message: error.message,\n            variant: 'error',\n            fixed: false,\n          }}\n          id=\"events\"\n        />\n      )}\n      {loading && <Skeleton variant=\"rect\" width=\"100%\" height=\"100%\" />}\n      {!loading && value !== undefined && (\n        <EventsContent warningEventsOnly={warningEventsOnly} events={value} />\n      )}\n    </>\n  );\n};\n"],"names":[],"mappings":"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"}