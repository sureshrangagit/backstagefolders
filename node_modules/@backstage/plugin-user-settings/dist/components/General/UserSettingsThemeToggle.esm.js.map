{"version":3,"file":"UserSettingsThemeToggle.esm.js","sources":["../../../src/components/General/UserSettingsThemeToggle.tsx"],"sourcesContent":["/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { MouseEvent, cloneElement } from 'react';\nimport useObservable from 'react-use/esm/useObservable';\nimport AutoIcon from '@material-ui/icons/BrightnessAuto';\nimport ToggleButton from '@material-ui/lab/ToggleButton';\nimport ToggleButtonGroup from '@material-ui/lab/ToggleButtonGroup';\nimport ListItem from '@material-ui/core/ListItem';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport ListItemSecondaryAction from '@material-ui/core/ListItemSecondaryAction';\nimport Tooltip from '@material-ui/core/Tooltip';\nimport { makeStyles } from '@material-ui/core/styles';\nimport { appThemeApiRef, useApi } from '@backstage/core-plugin-api';\nimport { useTranslationRef } from '@backstage/core-plugin-api/alpha';\nimport { userSettingsTranslationRef } from '../../translation';\n\ntype ThemeIconProps = {\n  id: string;\n  activeId: string | undefined;\n  icon: JSX.Element | undefined;\n};\n\nconst ThemeIcon = ({ id, activeId, icon }: ThemeIconProps) =>\n  icon ? (\n    cloneElement(icon, {\n      color: activeId === id ? 'primary' : undefined,\n    })\n  ) : (\n    <AutoIcon color={activeId === id ? 'primary' : undefined} />\n  );\n\ntype TooltipToggleButtonProps = {\n  children: JSX.Element;\n  title: string;\n  value: string;\n};\n\nconst useStyles = makeStyles(theme => ({\n  container: {\n    display: 'flex',\n    flexWrap: 'wrap',\n    width: '100%',\n    justifyContent: 'space-between',\n    alignItems: 'center',\n    paddingBottom: 8,\n    paddingRight: 16,\n  },\n  list: {\n    width: 'initial',\n    [theme.breakpoints.down('xs')]: {\n      width: '100%',\n      padding: `0 0 12px`,\n    },\n  },\n  listItemText: {\n    paddingRight: 0,\n    paddingLeft: 0,\n  },\n  listItemSecondaryAction: {\n    position: 'relative',\n    transform: 'unset',\n    top: 'auto',\n    right: 'auto',\n    paddingLeft: 16,\n    [theme.breakpoints.down('xs')]: {\n      paddingLeft: 0,\n    },\n  },\n}));\n\n// ToggleButtonGroup uses React.children.map instead of context\n// so wrapping with Tooltip breaks ToggleButton functionality.\nconst TooltipToggleButton = ({\n  children,\n  title,\n  value,\n  ...props\n}: TooltipToggleButtonProps) => (\n  <Tooltip placement=\"top\" arrow title={title}>\n    <ToggleButton value={value} {...props}>\n      {children}\n    </ToggleButton>\n  </Tooltip>\n);\n\n/** @public */\nexport const UserSettingsThemeToggle = () => {\n  const classes = useStyles();\n  const appThemeApi = useApi(appThemeApiRef);\n  const activeThemeId = useObservable(\n    appThemeApi.activeThemeId$(),\n    appThemeApi.getActiveThemeId(),\n  );\n\n  const themeIds = appThemeApi.getInstalledThemes();\n\n  const { t } = useTranslationRef(userSettingsTranslationRef);\n\n  const handleSetTheme = (\n    _event: MouseEvent<HTMLElement>,\n    newThemeId: string | undefined,\n  ) => {\n    if (themeIds.some(it => it.id === newThemeId)) {\n      appThemeApi.setActiveThemeId(newThemeId);\n    } else {\n      appThemeApi.setActiveThemeId(undefined);\n    }\n  };\n\n  return (\n    <ListItem\n      className={classes.list}\n      classes={{ container: classes.container }}\n    >\n      <ListItemText\n        className={classes.listItemText}\n        primary={t('themeToggle.title')}\n        secondary={t('themeToggle.description')}\n      />\n      <ListItemSecondaryAction className={classes.listItemSecondaryAction}>\n        <ToggleButtonGroup\n          exclusive\n          size=\"small\"\n          value={activeThemeId ?? 'auto'}\n          onChange={handleSetTheme}\n        >\n          {themeIds.map(theme => {\n            const themeId = theme.id;\n            const themeIcon = theme.icon;\n            const themeTitle =\n              theme.title ||\n              (themeId === 'light' || themeId === 'dark'\n                ? t(`themeToggle.names.${themeId}`)\n                : themeId);\n            return (\n              <TooltipToggleButton\n                key={themeId}\n                title={t('themeToggle.select', { theme: themeTitle })}\n                value={themeId}\n              >\n                <>\n                  {themeTitle}&nbsp;\n                  <ThemeIcon\n                    id={themeId}\n                    icon={themeIcon}\n                    activeId={activeThemeId}\n                  />\n                </>\n              </TooltipToggleButton>\n            );\n          })}\n          <Tooltip placement=\"top\" arrow title={t('themeToggle.selectAuto')}>\n            <ToggleButton value=\"auto\" selected={activeThemeId === undefined}>\n              {t('themeToggle.names.auto')}&nbsp;\n              <AutoIcon\n                color={activeThemeId === undefined ? 'primary' : undefined}\n              />\n            </ToggleButton>\n          </Tooltip>\n        </ToggleButtonGroup>\n      </ListItemSecondaryAction>\n    </ListItem>\n  );\n};\n"],"names":[],"mappings":"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"}