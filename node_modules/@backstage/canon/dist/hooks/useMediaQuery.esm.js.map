{"version":3,"file":"useMediaQuery.esm.js","sources":["../../src/hooks/useMediaQuery.ts"],"sourcesContent":["/*\n * Copyright 2024 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { useState } from 'react';\n\nimport { useIsomorphicLayoutEffect } from './useIsomorphicLayoutEffect';\n\ntype UseMediaQueryOptions = {\n  defaultValue?: boolean;\n  initializeWithValue?: boolean;\n};\n\nconst IS_SERVER = typeof window === 'undefined';\n\nexport function useMediaQuery(\n  query: string,\n  {\n    defaultValue = false,\n    initializeWithValue = true,\n  }: UseMediaQueryOptions = {},\n): boolean {\n  const getMatches = (query: string): boolean => {\n    if (IS_SERVER) {\n      return defaultValue;\n    }\n    return window.matchMedia(query).matches;\n  };\n\n  const [matches, setMatches] = useState<boolean>(() => {\n    if (initializeWithValue) {\n      return getMatches(query);\n    }\n    return defaultValue;\n  });\n\n  // Handles the change event of the media query.\n  function handleChange() {\n    setMatches(getMatches(query));\n  }\n\n  useIsomorphicLayoutEffect(() => {\n    const matchMedia = window.matchMedia(query);\n\n    // Triggered at the first client-side load and if query changes\n    handleChange();\n\n    // Use deprecated `addListener` and `removeListener` to support Safari < 14 (#135)\n    if (matchMedia.addListener) {\n      matchMedia.addListener(handleChange);\n    } else {\n      matchMedia.addEventListener('change', handleChange);\n    }\n\n    return () => {\n      if (matchMedia.removeListener) {\n        matchMedia.removeListener(handleChange);\n      } else {\n        matchMedia.removeEventListener('change', handleChange);\n      }\n    };\n  }, [query]);\n\n  return matches;\n}\n"],"names":["query"],"mappings":";;;AAwBA,MAAM,SAAA,GAAY,OAAO,MAAW,KAAA,WAAA;AAE7B,SAAS,cACd,KACA,EAAA;AAAA,EACE,YAAe,GAAA,KAAA;AAAA,EACf,mBAAsB,GAAA;AACxB,CAAA,GAA0B,EACjB,EAAA;AACT,EAAM,MAAA,UAAA,GAAa,CAACA,MAA2B,KAAA;AAC7C,IAAA,IAAI,SAAW,EAAA;AACb,MAAO,OAAA,YAAA;AAAA;AAET,IAAO,OAAA,MAAA,CAAO,UAAWA,CAAAA,MAAK,CAAE,CAAA,OAAA;AAAA,GAClC;AAEA,EAAA,MAAM,CAAC,OAAA,EAAS,UAAU,CAAA,GAAI,SAAkB,MAAM;AACpD,IAAA,IAAI,mBAAqB,EAAA;AACvB,MAAA,OAAO,WAAW,KAAK,CAAA;AAAA;AAEzB,IAAO,OAAA,YAAA;AAAA,GACR,CAAA;AAGD,EAAA,SAAS,YAAe,GAAA;AACtB,IAAW,UAAA,CAAA,UAAA,CAAW,KAAK,CAAC,CAAA;AAAA;AAG9B,EAAA,yBAAA,CAA0B,MAAM;AAC9B,IAAM,MAAA,UAAA,GAAa,MAAO,CAAA,UAAA,CAAW,KAAK,CAAA;AAG1C,IAAa,YAAA,EAAA;AAGb,IAAA,IAAI,WAAW,WAAa,EAAA;AAC1B,MAAA,UAAA,CAAW,YAAY,YAAY,CAAA;AAAA,KAC9B,MAAA;AACL,MAAW,UAAA,CAAA,gBAAA,CAAiB,UAAU,YAAY,CAAA;AAAA;AAGpD,IAAA,OAAO,MAAM;AACX,MAAA,IAAI,WAAW,cAAgB,EAAA;AAC7B,QAAA,UAAA,CAAW,eAAe,YAAY,CAAA;AAAA,OACjC,MAAA;AACL,QAAW,UAAA,CAAA,mBAAA,CAAoB,UAAU,YAAY,CAAA;AAAA;AACvD,KACF;AAAA,GACF,EAAG,CAAC,KAAK,CAAC,CAAA;AAEV,EAAO,OAAA,OAAA;AACT;;;;"}