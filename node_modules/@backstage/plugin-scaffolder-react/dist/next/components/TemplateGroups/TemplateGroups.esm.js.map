{"version":3,"file":"TemplateGroups.esm.js","sources":["../../../../src/next/components/TemplateGroups/TemplateGroups.tsx"],"sourcesContent":["/*\n * Copyright 2022 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { Link, Progress } from '@backstage/core-components';\nimport { errorApiRef, IconComponent, useApi } from '@backstage/core-plugin-api';\nimport { useEntityList } from '@backstage/plugin-catalog-react';\nimport {\n  isTemplateEntityV1beta3,\n  TemplateEntityV1beta3,\n} from '@backstage/plugin-scaffolder-common';\nimport { TemplateGroupFilter } from '@backstage/plugin-scaffolder-react';\nimport Typography from '@material-ui/core/Typography';\nimport { ComponentType, useCallback, useEffect } from 'react';\n\nimport { TemplateGroup } from '../TemplateGroup/TemplateGroup';\n\n/**\n * @alpha\n */\nexport interface TemplateGroupsProps {\n  groups: TemplateGroupFilter[];\n  templateFilter?: (entity: TemplateEntityV1beta3) => boolean;\n  TemplateCardComponent?: ComponentType<{\n    template: TemplateEntityV1beta3;\n  }>;\n  onTemplateSelected?: (template: TemplateEntityV1beta3) => void;\n  additionalLinksForEntity?: (template: TemplateEntityV1beta3) => {\n    icon: IconComponent;\n    text: string;\n    url: string;\n  }[];\n}\n\n/**\n * @alpha\n */\nexport const TemplateGroups = (props: TemplateGroupsProps) => {\n  const { loading, error, entities } = useEntityList();\n  const { groups, templateFilter, TemplateCardComponent, onTemplateSelected } =\n    props;\n  const errorApi = useApi(errorApiRef);\n  const onSelected = useCallback(\n    (template: TemplateEntityV1beta3) => {\n      onTemplateSelected?.(template);\n    },\n    [onTemplateSelected],\n  );\n\n  useEffect(() => {\n    if (error) {\n      errorApi.post(error);\n    }\n  }, [error, errorApi]);\n\n  if (loading) {\n    return <Progress />;\n  }\n\n  if (error) {\n    return null;\n  }\n\n  if (!entities || !entities.length) {\n    return (\n      <Typography variant=\"body2\">\n        No templates found that match your filter. Learn more about{' '}\n        <Link to=\"https://backstage.io/docs/features/software-templates/adding-templates\">\n          adding templates\n        </Link>\n        .\n      </Typography>\n    );\n  }\n\n  return (\n    <>\n      {groups.map(({ title, filter }, index) => {\n        const templates = entities\n          .filter(isTemplateEntityV1beta3)\n          .filter(e => (templateFilter ? templateFilter(e) : true))\n          .filter(filter)\n          .map(template => {\n            const additionalLinks =\n              props.additionalLinksForEntity?.(template) ?? [];\n\n            return {\n              template,\n              additionalLinks,\n            };\n          });\n\n        return (\n          <TemplateGroup\n            key={index}\n            templates={templates}\n            title={title}\n            components={{ CardComponent: TemplateCardComponent }}\n            onSelected={onSelected}\n          />\n        );\n      })}\n    </>\n  );\n};\n"],"names":[],"mappings":";;;;;;;;;AAgDa,MAAA,cAAA,GAAiB,CAAC,KAA+B,KAAA;AAC5D,EAAA,MAAM,EAAE,OAAA,EAAS,KAAO,EAAA,QAAA,KAAa,aAAc,EAAA;AACnD,EAAA,MAAM,EAAE,MAAA,EAAQ,cAAgB,EAAA,qBAAA,EAAuB,oBACrD,GAAA,KAAA;AACF,EAAM,MAAA,QAAA,GAAW,OAAO,WAAW,CAAA;AACnC,EAAA,MAAM,UAAa,GAAA,WAAA;AAAA,IACjB,CAAC,QAAoC,KAAA;AACnC,MAAA,kBAAA,GAAqB,QAAQ,CAAA;AAAA,KAC/B;AAAA,IACA,CAAC,kBAAkB;AAAA,GACrB;AAEA,EAAA,SAAA,CAAU,MAAM;AACd,IAAA,IAAI,KAAO,EAAA;AACT,MAAA,QAAA,CAAS,KAAK,KAAK,CAAA;AAAA;AACrB,GACC,EAAA,CAAC,KAAO,EAAA,QAAQ,CAAC,CAAA;AAEpB,EAAA,IAAI,OAAS,EAAA;AACX,IAAA,2BAAQ,QAAS,EAAA,EAAA,CAAA;AAAA;AAGnB,EAAA,IAAI,KAAO,EAAA;AACT,IAAO,OAAA,IAAA;AAAA;AAGT,EAAA,IAAI,CAAC,QAAA,IAAY,CAAC,QAAA,CAAS,MAAQ,EAAA;AACjC,IACE,uBAAA,IAAA,CAAC,UAAW,EAAA,EAAA,OAAA,EAAQ,OAAQ,EAAA,QAAA,EAAA;AAAA,MAAA,6DAAA;AAAA,MACkC,GAAA;AAAA,sBAC3D,GAAA,CAAA,IAAA,EAAA,EAAK,EAAG,EAAA,wEAAA,EAAyE,QAElF,EAAA,kBAAA,EAAA,CAAA;AAAA,MAAO;AAAA,KAET,EAAA,CAAA;AAAA;AAIJ,EACE,uBAAA,GAAA,CAAA,QAAA,EAAA,EACG,iBAAO,GAAI,CAAA,CAAC,EAAE,KAAO,EAAA,MAAA,IAAU,KAAU,KAAA;AACxC,IAAA,MAAM,YAAY,QACf,CAAA,MAAA,CAAO,uBAAuB,CAAA,CAC9B,OAAO,CAAM,CAAA,KAAA,cAAA,GAAiB,cAAe,CAAA,CAAC,IAAI,IAAK,CAAA,CACvD,OAAO,MAAM,CAAA,CACb,IAAI,CAAY,QAAA,KAAA;AACf,MAAA,MAAM,eACJ,GAAA,KAAA,CAAM,wBAA2B,GAAA,QAAQ,KAAK,EAAC;AAEjD,MAAO,OAAA;AAAA,QACL,QAAA;AAAA,QACA;AAAA,OACF;AAAA,KACD,CAAA;AAEH,IACE,uBAAA,GAAA;AAAA,MAAC,aAAA;AAAA,MAAA;AAAA,QAEC,SAAA;AAAA,QACA,KAAA;AAAA,QACA,UAAA,EAAY,EAAE,aAAA,EAAe,qBAAsB,EAAA;AAAA,QACnD;AAAA,OAAA;AAAA,MAJK;AAAA,KAKP;AAAA,GAEH,CACH,EAAA,CAAA;AAEJ;;;;"}