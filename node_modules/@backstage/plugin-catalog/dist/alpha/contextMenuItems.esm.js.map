{"version":3,"file":"contextMenuItems.esm.js","sources":["../../src/alpha/contextMenuItems.tsx"],"sourcesContent":["/*\n * Copyright 2023 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  EntityContextMenuItemBlueprint,\n  useEntityPermission,\n} from '@backstage/plugin-catalog-react/alpha';\nimport FileCopyTwoToneIcon from '@material-ui/icons/FileCopyTwoTone';\nimport BugReportIcon from '@material-ui/icons/BugReport';\nimport CancelIcon from '@material-ui/icons/Cancel';\nimport useCopyToClipboard from 'react-use/esm/useCopyToClipboard';\nimport { alertApiRef, useApi, useRouteRef } from '@backstage/core-plugin-api';\nimport {\n  dialogApiRef,\n  useTranslationRef,\n  type DialogApiDialog,\n} from '@backstage/frontend-plugin-api';\nimport { catalogTranslationRef } from './translation';\nimport { useNavigate, useSearchParams } from 'react-router-dom';\nimport {\n  UnregisterEntityDialog,\n  useEntity,\n} from '@backstage/plugin-catalog-react';\nimport { rootRouteRef, unregisterRedirectRouteRef } from '../routes';\nimport { catalogEntityDeletePermission } from '@backstage/plugin-catalog-common/alpha';\nimport { useEffect } from 'react';\nimport { compatWrapper } from '@backstage/core-compat-api';\n\nexport const copyEntityUrlContextMenuItem = EntityContextMenuItemBlueprint.make(\n  {\n    name: 'copy-entity-url',\n    params: {\n      icon: <FileCopyTwoToneIcon fontSize=\"small\" />,\n      useProps: () => {\n        const [copyState, copyToClipboard] = useCopyToClipboard();\n        const alertApi = useApi(alertApiRef);\n        const { t } = useTranslationRef(catalogTranslationRef);\n\n        useEffect(() => {\n          if (!copyState.error && copyState.value) {\n            alertApi.post({\n              message: t('entityContextMenu.copiedMessage'),\n              severity: 'info',\n              display: 'transient',\n            });\n          }\n        }, [copyState, alertApi, t]);\n\n        return {\n          title: t('entityContextMenu.copyURLMenuTitle'),\n          onClick: async () => {\n            copyToClipboard(window.location.toString());\n          },\n        };\n      },\n    },\n  },\n);\n\nexport const inspectEntityContextMenuItem = EntityContextMenuItemBlueprint.make(\n  {\n    name: 'inspect-entity',\n    params: {\n      icon: <BugReportIcon fontSize=\"small\" />,\n      useProps: () => {\n        const [_, setSearchParams] = useSearchParams();\n        const { t } = useTranslationRef(catalogTranslationRef);\n\n        return {\n          title: t('entityContextMenu.inspectMenuTitle'),\n          onClick: async () => {\n            setSearchParams('inspect');\n          },\n        };\n      },\n    },\n  },\n);\n\nexport const unregisterEntityContextMenuItem =\n  EntityContextMenuItemBlueprint.make({\n    name: 'unregister-entity',\n    params: {\n      icon: <CancelIcon fontSize=\"small\" />,\n      useProps: () => {\n        const { entity } = useEntity();\n        const dialogApi = useApi(dialogApiRef);\n        const navigate = useNavigate();\n        const catalogRoute = useRouteRef(rootRouteRef);\n\n        const { t } = useTranslationRef(catalogTranslationRef);\n        const unregisterRedirectRoute = useRouteRef(unregisterRedirectRouteRef);\n        const unregisterPermission = useEntityPermission(\n          catalogEntityDeletePermission,\n        );\n\n        return {\n          title: t('entityContextMenu.unregisterMenuTitle'),\n          disabled: !unregisterPermission.allowed,\n          onClick: async () => {\n            dialogApi.showModal(({ dialog }: { dialog: DialogApiDialog }) =>\n              compatWrapper(\n                <UnregisterEntityDialog\n                  open\n                  entity={entity}\n                  onClose={() => dialog.close()}\n                  onConfirm={() => {\n                    dialog.close();\n                    navigate(\n                      unregisterRedirectRoute\n                        ? unregisterRedirectRoute()\n                        : catalogRoute(),\n                    );\n                  }}\n                />,\n              ),\n            );\n          },\n        };\n      },\n    },\n  });\n\nexport default [\n  unregisterEntityContextMenuItem,\n  inspectEntityContextMenuItem,\n  copyEntityUrlContextMenuItem,\n];\n"],"names":[],"mappings":"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"}