{"version":3,"file":"MissingAnnotationEmptyState.esm.js","sources":["../../../src/components/EmptyState/MissingAnnotationEmptyState.tsx"],"sourcesContent":["/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport Box from '@material-ui/core/Box';\nimport Button from '@material-ui/core/Button';\nimport { makeStyles } from '@material-ui/core/styles';\nimport Typography from '@material-ui/core/Typography';\n\nimport { CodeSnippet } from '../CodeSnippet';\nimport { Link } from '../Link';\nimport { EmptyState } from './EmptyState';\nimport { useTranslationRef } from '@backstage/core-plugin-api/alpha';\nimport { coreComponentsTranslationRef } from '../../translation';\n\nconst COMPONENT_YAML_TEMPLATE = `apiVersion: backstage.io/v1alpha1\nkind: Component\nmetadata:\n  name: example\n  description: example.com\n  annotations:\n    ANNOTATION: value\nspec:\n  type: website\n  lifecycle: production\n  owner: user:guest`;\n\nconst ANNOTATION_REGEXP = /^.*ANNOTATION.*$/m;\nconst ANNOTATION_YAML = COMPONENT_YAML_TEMPLATE.match(ANNOTATION_REGEXP)![0];\nconst ANNOTATION_LINE = COMPONENT_YAML_TEMPLATE.split('\\n').findIndex(line =>\n  ANNOTATION_REGEXP.test(line),\n);\n\ntype Props = {\n  annotation: string | string[];\n  readMoreUrl?: string;\n};\n\nconst useStyles = makeStyles(\n  theme => ({\n    code: {\n      borderRadius: 6,\n      margin: theme.spacing(2, 0),\n      background:\n        theme.palette.type === 'dark' ? '#444' : theme.palette.common.white,\n    },\n  }),\n  { name: 'BackstageMissingAnnotationEmptyState' },\n);\n\nfunction generateLineNumbers(lineCount: number) {\n  return Array.from(Array(lineCount + 1).keys(), i => i + ANNOTATION_LINE);\n}\n\nfunction generateComponentYaml(annotations: string[]) {\n  const annotationYaml = annotations\n    .map(ann => ANNOTATION_YAML.replace('ANNOTATION', ann))\n    .join('\\n');\n  return COMPONENT_YAML_TEMPLATE.replace(ANNOTATION_YAML, annotationYaml);\n}\n\nfunction useGenerateDescription(annotations: string[]) {\n  const isSingular = annotations.length <= 1;\n  return (\n    <>\n      The {isSingular ? 'annotation' : 'annotations'}{' '}\n      {annotations\n        .map(ann => <code>{ann}</code>)\n        .reduce((prev, curr) => (\n          <>\n            {prev}, {curr}\n          </>\n        ))}{' '}\n      {isSingular ? 'is' : 'are'} missing. You need to add the{' '}\n      {isSingular ? 'annotation' : 'annotations'} to your component if you want\n      to enable this tool.\n    </>\n  );\n}\n\n/**\n * @public\n * @deprecated This component is deprecated, please use {@link @backstage/plugin-catalog-react#MissingAnnotationEmptyState} instead\n */\nexport function MissingAnnotationEmptyState(props: Props) {\n  const { annotation, readMoreUrl } = props;\n  const annotations = Array.isArray(annotation) ? annotation : [annotation];\n  const url =\n    readMoreUrl ||\n    'https://backstage.io/docs/features/software-catalog/well-known-annotations';\n  const classes = useStyles();\n  const { t } = useTranslationRef(coreComponentsTranslationRef);\n\n  return (\n    <EmptyState\n      missing=\"field\"\n      title={t('emptyState.missingAnnotation.title')}\n      description={useGenerateDescription(annotations)}\n      action={\n        <>\n          <Typography variant=\"body1\">\n            {t('emptyState.missingAnnotation.actionTitle')}\n          </Typography>\n          <Box className={classes.code}>\n            <CodeSnippet\n              text={generateComponentYaml(annotations)}\n              language=\"yaml\"\n              showLineNumbers\n              highlightedNumbers={generateLineNumbers(annotations.length)}\n              customStyle={{ background: 'inherit', fontSize: '115%' }}\n            />\n          </Box>\n          <Button color=\"primary\" component={Link} to={url}>\n            {t('emptyState.missingAnnotation.readMore')}\n          </Button>\n        </>\n      }\n    />\n  );\n}\n"],"names":[],"mappings":"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"}