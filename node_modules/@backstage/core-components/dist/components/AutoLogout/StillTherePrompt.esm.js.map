{"version":3,"file":"StillTherePrompt.esm.js","sources":["../../../src/components/AutoLogout/StillTherePrompt.tsx"],"sourcesContent":["/*\n * Copyright 2023 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport Button from '@material-ui/core/Button';\nimport Dialog from '@material-ui/core/Dialog';\nimport DialogActions from '@material-ui/core/DialogActions';\nimport DialogContent from '@material-ui/core/DialogContent';\nimport DialogContentText from '@material-ui/core/DialogContentText';\nimport DialogTitle from '@material-ui/core/DialogTitle';\nimport { useEffect } from 'react';\nimport { IIdleTimer } from 'react-idle-timer';\nimport { coreComponentsTranslationRef } from '../../translation';\nimport { useTranslationRef } from '@backstage/core-plugin-api/alpha';\n\nexport interface StillTherePromptProps {\n  idleTimer: IIdleTimer;\n  promptTimeoutMillis: number;\n  remainingTime: number;\n  setRemainingTime: (amount: number) => void;\n  open: boolean;\n  setOpen: (value: boolean) => void;\n}\n\nexport const StillTherePrompt = (props: StillTherePromptProps) => {\n  const {\n    idleTimer,\n    setOpen,\n    open,\n    promptTimeoutMillis,\n    remainingTime,\n    setRemainingTime,\n  } = props;\n  const { t } = useTranslationRef(coreComponentsTranslationRef);\n\n  useEffect(() => {\n    const interval = setInterval(() => {\n      setRemainingTime(Math.ceil(idleTimer.getRemainingTime()));\n    }, 500);\n\n    return () => {\n      clearInterval(interval);\n    };\n  }, [idleTimer, setRemainingTime]);\n\n  const handleStillHere = () => {\n    setOpen(false);\n    idleTimer.activate();\n  };\n\n  const timeTillPrompt = Math.max(\n    remainingTime - promptTimeoutMillis / 1000,\n    0,\n  );\n  const seconds = timeTillPrompt > 1 ? 'seconds' : 'second';\n\n  return (\n    <Dialog open={open} data-testid=\"inactivity-prompt-dialog\">\n      <DialogTitle>{t('autoLogout.stillTherePrompt.title')}</DialogTitle>\n      <DialogContent>\n        <DialogContentText>\n          You are about to be disconnected in{' '}\n          <b>\n            {Math.ceil(remainingTime / 1000)} {seconds}\n          </b>\n          . Are you still there?\n        </DialogContentText>\n      </DialogContent>\n      <DialogActions>\n        <Button\n          onClick={handleStillHere}\n          color=\"secondary\"\n          variant=\"contained\"\n          size=\"small\"\n        >\n          {t('autoLogout.stillTherePrompt.buttonText')}\n        </Button>\n      </DialogActions>\n    </Dialog>\n  );\n};\n"],"names":[],"mappings":";;;;;;;;;;;AAoCa,MAAA,gBAAA,GAAmB,CAAC,KAAiC,KAAA;AAChE,EAAM,MAAA;AAAA,IACJ,SAAA;AAAA,IACA,OAAA;AAAA,IACA,IAAA;AAAA,IACA,mBAAA;AAAA,IACA,aAAA;AAAA,IACA;AAAA,GACE,GAAA,KAAA;AACJ,EAAA,MAAM,EAAE,CAAA,EAAM,GAAA,iBAAA,CAAkB,4BAA4B,CAAA;AAE5D,EAAA,SAAA,CAAU,MAAM;AACd,IAAM,MAAA,QAAA,GAAW,YAAY,MAAM;AACjC,MAAA,gBAAA,CAAiB,IAAK,CAAA,IAAA,CAAK,SAAU,CAAA,gBAAA,EAAkB,CAAC,CAAA;AAAA,OACvD,GAAG,CAAA;AAEN,IAAA,OAAO,MAAM;AACX,MAAA,aAAA,CAAc,QAAQ,CAAA;AAAA,KACxB;AAAA,GACC,EAAA,CAAC,SAAW,EAAA,gBAAgB,CAAC,CAAA;AAEhC,EAAA,MAAM,kBAAkB,MAAM;AAC5B,IAAA,OAAA,CAAQ,KAAK,CAAA;AACb,IAAA,SAAA,CAAU,QAAS,EAAA;AAAA,GACrB;AAEA,EAAA,MAAM,iBAAiB,IAAK,CAAA,GAAA;AAAA,IAC1B,gBAAgB,mBAAsB,GAAA,GAAA;AAAA,IACtC;AAAA,GACF;AACA,EAAM,MAAA,OAAA,GAAU,cAAiB,GAAA,CAAA,GAAI,SAAY,GAAA,QAAA;AAEjD,EAAA,uBACG,IAAA,CAAA,MAAA,EAAA,EAAO,IAAY,EAAA,aAAA,EAAY,0BAC9B,EAAA,QAAA,EAAA;AAAA,oBAAC,GAAA,CAAA,WAAA,EAAA,EAAa,QAAE,EAAA,CAAA,CAAA,mCAAmC,CAAE,EAAA,CAAA;AAAA,oBACrD,GAAA,CAAC,aACC,EAAA,EAAA,QAAA,kBAAA,IAAA,CAAC,iBAAkB,EAAA,EAAA,QAAA,EAAA;AAAA,MAAA,qCAAA;AAAA,MACmB,GAAA;AAAA,2BACnC,GACE,EAAA,EAAA,QAAA,EAAA;AAAA,QAAK,IAAA,CAAA,IAAA,CAAK,gBAAgB,GAAI,CAAA;AAAA,QAAE,GAAA;AAAA,QAAE;AAAA,OACrC,EAAA,CAAA;AAAA,MAAI;AAAA,KAAA,EAEN,CACF,EAAA,CAAA;AAAA,wBACC,aACC,EAAA,EAAA,QAAA,kBAAA,GAAA;AAAA,MAAC,MAAA;AAAA,MAAA;AAAA,QACC,OAAS,EAAA,eAAA;AAAA,QACT,KAAM,EAAA,WAAA;AAAA,QACN,OAAQ,EAAA,WAAA;AAAA,QACR,IAAK,EAAA,OAAA;AAAA,QAEJ,YAAE,wCAAwC;AAAA;AAAA,KAE/C,EAAA;AAAA,GACF,EAAA,CAAA;AAEJ;;;;"}