{"version":3,"file":"OAuthRequestDialog.esm.js","sources":["../../../src/components/OAuthRequestDialog/OAuthRequestDialog.tsx"],"sourcesContent":["/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { makeStyles } from '@material-ui/core/styles';\nimport Dialog from '@material-ui/core/Dialog';\nimport DialogActions from '@material-ui/core/DialogActions';\nimport DialogContent from '@material-ui/core/DialogContent';\nimport DialogTitle from '@material-ui/core/DialogTitle';\nimport List from '@material-ui/core/List';\nimport Button from '@material-ui/core/Button';\nimport { useMemo, useState } from 'react';\nimport useObservable from 'react-use/esm/useObservable';\nimport LoginRequestListItem from './LoginRequestListItem';\nimport {\n  useApi,\n  configApiRef,\n  oauthRequestApiRef,\n} from '@backstage/core-plugin-api';\nimport Typography from '@material-ui/core/Typography';\nimport { coreComponentsTranslationRef } from '../../translation';\nimport { useTranslationRef } from '@backstage/core-plugin-api/alpha';\n\nexport type OAuthRequestDialogClassKey =\n  | 'dialog'\n  | 'title'\n  | 'contentList'\n  | 'actionButtons';\n\nconst useStyles = makeStyles(\n  theme => ({\n    dialog: {\n      paddingTop: theme.spacing(1),\n    },\n    title: {\n      minWidth: 0,\n    },\n    titleHeading: {\n      fontSize: theme.typography.h6.fontSize,\n    },\n    contentList: {\n      padding: 0,\n    },\n    actionButtons: {\n      padding: theme.spacing(2, 0),\n    },\n  }),\n  { name: 'OAuthRequestDialog' },\n);\n\nexport function OAuthRequestDialog(_props: {}) {\n  const classes = useStyles();\n  const [busy, setBusy] = useState(false);\n  const oauthRequestApi = useApi(oauthRequestApiRef);\n  const configApi = useApi(configApiRef);\n  const { t } = useTranslationRef(coreComponentsTranslationRef);\n\n  const authRedirect =\n    configApi.getOptionalBoolean('enableExperimentalRedirectFlow') ?? false;\n\n  const requests = useObservable(\n    useMemo(() => oauthRequestApi.authRequest$(), [oauthRequestApi]),\n    [],\n  );\n\n  const handleRejectAll = () => {\n    requests.forEach(request => request.reject());\n  };\n\n  return (\n    <Dialog\n      open={Boolean(requests.length)}\n      fullWidth\n      maxWidth=\"xs\"\n      classes={{ paper: classes.dialog }}\n      aria-labelledby=\"oauth-req-dialog-title\"\n    >\n      <main>\n        <DialogTitle\n          classes={{ root: classes.title }}\n          id=\"oauth-req-dialog-title\"\n        >\n          <Typography\n            className={classes.titleHeading}\n            variant=\"h1\"\n            variantMapping={{ h1: 'span' }}\n          >\n            {t('oauthRequestDialog.title')}\n          </Typography>\n          {authRedirect ? (\n            <Typography>{t('oauthRequestDialog.authRedirectTitle')}</Typography>\n          ) : null}\n        </DialogTitle>\n\n        <DialogContent dividers classes={{ root: classes.contentList }}>\n          <List>\n            {requests.map(request => (\n              <LoginRequestListItem\n                key={request.provider.title}\n                request={request}\n                busy={busy}\n                setBusy={setBusy}\n              />\n            ))}\n          </List>\n        </DialogContent>\n      </main>\n\n      <DialogActions classes={{ root: classes.actionButtons }}>\n        <Button onClick={handleRejectAll}>\n          {t('oauthRequestDialog.rejectAll')}\n        </Button>\n      </DialogActions>\n    </Dialog>\n  );\n}\n"],"names":[],"mappings":"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"}