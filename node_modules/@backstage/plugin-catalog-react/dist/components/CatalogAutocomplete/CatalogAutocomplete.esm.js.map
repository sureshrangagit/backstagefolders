{"version":3,"file":"CatalogAutocomplete.esm.js","sources":["../../../src/components/CatalogAutocomplete/CatalogAutocomplete.tsx"],"sourcesContent":["/*\n * Copyright 2024 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport Box from '@material-ui/core/Box';\nimport Typography, { TypographyProps } from '@material-ui/core/Typography';\nimport Paper, { PaperProps } from '@material-ui/core/Paper';\nimport Popper, { PopperProps } from '@material-ui/core/Popper';\nimport TextField, { OutlinedTextFieldProps } from '@material-ui/core/TextField';\nimport Grow from '@material-ui/core/Grow';\nimport {\n  createStyles,\n  makeStyles,\n  Theme,\n  withStyles,\n} from '@material-ui/core/styles';\nimport ExpandMoreIcon from '@material-ui/icons/ExpandMore';\nimport Autocomplete, {\n  AutocompleteProps,\n  AutocompleteRenderInputParams,\n} from '@material-ui/lab/Autocomplete';\nimport { ReactNode, useCallback } from 'react';\nimport { merge } from 'lodash';\nimport classNames from 'classnames';\n\nconst useStyles = makeStyles(\n  theme => ({\n    root: {\n      margin: theme.spacing(1, 0),\n    },\n    label: {\n      position: 'relative',\n      fontWeight: 'bold',\n      fontSize: theme.typography.body2.fontSize,\n      fontFamily: theme.typography.fontFamily,\n      color: theme.palette.text.primary,\n      '& > span': {\n        top: 0,\n        left: 0,\n        position: 'absolute',\n      },\n    },\n  }),\n  { name: 'BackstageAutocomplete' },\n);\n\nconst BootstrapAutocomplete = withStyles(\n  (theme: Theme) =>\n    createStyles({\n      root: {},\n      paper: {\n        margin: 0,\n      },\n      hasClearIcon: {},\n      hasPopupIcon: {},\n      focused: {},\n      inputRoot: {\n        marginTop: 24,\n        backgroundColor: theme.palette.background.paper,\n        '$root$hasClearIcon$hasPopupIcon &': {\n          paddingBlock: theme.spacing(0.75),\n          paddingInlineStart: theme.spacing(0.75),\n        },\n        '$root$focused &': {\n          outline: 'none',\n        },\n        '$root &:hover > fieldset': {\n          borderColor: '#ced4da',\n        },\n        '$root$focused & > fieldset': {\n          borderWidth: 1,\n          borderColor: theme.palette.primary.main,\n        },\n      },\n      popupIndicator: {\n        padding: 0,\n        margin: 0,\n        color: '#616161',\n        '&:hover': {\n          backgroundColor: 'unset',\n        },\n        '& [class*=\"MuiTouchRipple-root\"]': {\n          display: 'none',\n        },\n      },\n      endAdornment: {\n        '$root$hasClearIcon$hasPopupIcon &': {\n          right: 4,\n        },\n      },\n      input: {\n        '$root$hasClearIcon$hasPopupIcon &': {\n          fontSize: theme.typography.body1.fontSize,\n          paddingBlock: theme.spacing(0.8125),\n        },\n      },\n    }),\n  { name: 'BackstageAutocompleteBase' },\n)(Autocomplete) as typeof Autocomplete;\n\nconst PopperComponent = (props: PopperProps) => (\n  <Popper {...props} transition placement=\"bottom-start\">\n    {({ TransitionProps }) => (\n      <Grow {...TransitionProps} style={{ transformOrigin: '0 0 0' }}>\n        <Box>{props.children as ReactNode}</Box>\n      </Grow>\n    )}\n  </Popper>\n);\n\nconst PaperComponent = (props: PaperProps) => (\n  <Paper {...props} elevation={8} />\n);\n\n/**\n * Props for {@link CatalogAutocomplete}\n *\n * @public\n */\nexport type CatalogAutocompleteProps<\n  T,\n  Multiple extends boolean | undefined = undefined,\n  DisableClearable extends boolean | undefined = undefined,\n  FreeSolo extends boolean | undefined = undefined,\n> = Omit<\n  AutocompleteProps<T, Multiple, DisableClearable, FreeSolo>,\n  'PopperComponent' | 'PaperComponent' | 'popupIcon' | 'renderInput'\n> & {\n  name: string;\n  label?: string;\n  LabelProps?: TypographyProps<'label'>;\n  TextFieldProps?: Omit<OutlinedTextFieldProps, 'variant'>;\n  renderInput?: AutocompleteProps<\n    T,\n    Multiple,\n    DisableClearable,\n    FreeSolo\n  >['renderInput'];\n};\n\n/** @public */\nexport function CatalogAutocomplete<\n  T,\n  Multiple extends boolean | undefined = undefined,\n  DisableClearable extends boolean | undefined = undefined,\n  FreeSolo extends boolean | undefined = undefined,\n>(props: CatalogAutocompleteProps<T, Multiple, DisableClearable, FreeSolo>) {\n  const { label, name, LabelProps, TextFieldProps, ...rest } = props;\n  const classes = useStyles();\n  const renderInput = useCallback(\n    (params: AutocompleteRenderInputParams) => (\n      <TextField {...merge(params, TextFieldProps)} variant=\"outlined\" />\n    ),\n    [TextFieldProps],\n  );\n  const autocomplete = (\n    <BootstrapAutocomplete\n      size=\"small\"\n      {...rest}\n      renderInput={rest.renderInput ?? renderInput}\n      popupIcon={<ExpandMoreIcon data-testid={`${name}-expand`} />}\n      PaperComponent={PaperComponent}\n      PopperComponent={PopperComponent}\n    />\n  );\n\n  return (\n    <Box className={classes.root}>\n      {label ? (\n        <Typography\n          {...LabelProps}\n          className={classNames(classes.label, LabelProps?.className)}\n          component=\"label\"\n        >\n          <Box component=\"span\">{label}</Box>\n          {autocomplete}\n        </Typography>\n      ) : (\n        autocomplete\n      )}\n    </Box>\n  );\n}\n"],"names":[],"mappings":"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"}